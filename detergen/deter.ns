set ns [new Simulator]
source tb_compat.tcl

tb-use-endnodeshaping 1
set n_nodes 15
set n_routers 15

for {set i 0} {$i < $n_nodes} {incr i} {
	set site($i) [$ns node]
	tb-set-hardware $site($i) {MicroCloud}
	tb-set-node-os $site($i) Ubuntu1404-64-STD
}
for {set i 0} {$i < $n_routers} {incr i} {
	set router($i) [$ns node]
	tb-set-hardware $router($i) {MicroCloud}
	tb-set-node-os $router($i) Ubuntu1404-64-STD
}

set link0 [$ns duplex-link $router(0) $router(1) 100Mb 2.423410ms DropTail]
tb-set-ip-link $router(0) $link0 10.1.1.2
tb-set-ip-link $router(1) $link0 10.1.1.3
set link1 [$ns duplex-link $router(0) $router(3) 100Mb 11.156760ms DropTail]
tb-set-ip-link $router(0) $link1 10.1.2.2
tb-set-ip-link $router(3) $link1 10.1.2.3
set link2 [$ns duplex-link $router(0) $router(4) 100Mb 82.658291ms DropTail]
tb-set-ip-link $router(0) $link2 10.1.3.2
tb-set-ip-link $router(4) $link2 10.1.3.3
set link3 [$ns duplex-link $router(0) $router(11) 100Mb 52.022567ms DropTail]
tb-set-ip-link $router(0) $link3 10.1.4.2
tb-set-ip-link $router(11) $link3 10.1.4.3
set link4 [$ns duplex-link $router(1) $router(9) 100Mb 78.412438ms DropTail]
tb-set-ip-link $router(1) $link4 10.1.5.2
tb-set-ip-link $router(9) $link4 10.1.5.3
set link5 [$ns duplex-link $router(1) $router(12) 100Mb 24.383738ms DropTail]
tb-set-ip-link $router(1) $link5 10.1.6.2
tb-set-ip-link $router(12) $link5 10.1.6.3
set link6 [$ns duplex-link $router(1) $router(2) 100Mb 29.007528ms DropTail]
tb-set-ip-link $router(1) $link6 10.1.7.2
tb-set-ip-link $router(2) $link6 10.1.7.3
set link7 [$ns duplex-link $router(2) $router(14) 100Mb 45.318963ms DropTail]
tb-set-ip-link $router(2) $link7 10.1.8.2
tb-set-ip-link $router(14) $link7 10.1.8.3
set link8 [$ns duplex-link $router(2) $router(5) 100Mb 37.206792ms DropTail]
tb-set-ip-link $router(2) $link8 10.1.9.2
tb-set-ip-link $router(5) $link8 10.1.9.3
set link9 [$ns duplex-link $router(2) $router(12) 100Mb 53.391139ms DropTail]
tb-set-ip-link $router(2) $link9 10.1.10.2
tb-set-ip-link $router(12) $link9 10.1.10.3
set link10 [$ns duplex-link $router(3) $router(13) 100Mb 6.331693ms DropTail]
tb-set-ip-link $router(3) $link10 10.1.11.2
tb-set-ip-link $router(13) $link10 10.1.11.3
set link11 [$ns duplex-link $router(3) $router(11) 100Mb 40.882672ms DropTail]
tb-set-ip-link $router(3) $link11 10.1.12.2
tb-set-ip-link $router(11) $link11 10.1.12.3
set link12 [$ns duplex-link $router(3) $router(5) 100Mb 0.000000ms DropTail]
tb-set-ip-link $router(3) $link12 10.1.13.2
tb-set-ip-link $router(5) $link12 10.1.13.3
set link13 [$ns duplex-link $router(4) $router(13) 100Mb 77.836812ms DropTail]
tb-set-ip-link $router(4) $link13 10.1.14.2
tb-set-ip-link $router(13) $link13 10.1.14.3
set link14 [$ns duplex-link $router(4) $router(10) 100Mb 12.899006ms DropTail]
tb-set-ip-link $router(4) $link14 10.1.15.2
tb-set-ip-link $router(10) $link14 10.1.15.3
set link15 [$ns duplex-link $router(4) $router(8) 100Mb 105.335667ms DropTail]
tb-set-ip-link $router(4) $link15 10.1.16.2
tb-set-ip-link $router(8) $link15 10.1.16.3
set link16 [$ns duplex-link $router(5) $router(10) 100Mb 59.273768ms DropTail]
tb-set-ip-link $router(5) $link16 10.1.17.2
tb-set-ip-link $router(10) $link16 10.1.17.3
set link17 [$ns duplex-link $router(5) $router(8) 100Mb 33.311241ms DropTail]
tb-set-ip-link $router(5) $link17 10.1.18.2
tb-set-ip-link $router(8) $link17 10.1.18.3
set link18 [$ns duplex-link $router(6) $router(7) 100Mb 62.705529ms DropTail]
tb-set-ip-link $router(6) $link18 10.1.19.2
tb-set-ip-link $router(7) $link18 10.1.19.3
set link19 [$ns duplex-link $router(6) $router(10) 100Mb 68.270588ms DropTail]
tb-set-ip-link $router(6) $link19 10.1.20.2
tb-set-ip-link $router(10) $link19 10.1.20.3
set link20 [$ns duplex-link $router(6) $router(11) 100Mb 50.419561ms DropTail]
tb-set-ip-link $router(6) $link20 10.1.21.2
tb-set-ip-link $router(11) $link20 10.1.21.3
set link21 [$ns duplex-link $router(6) $router(13) 100Mb 3.273089ms DropTail]
tb-set-ip-link $router(6) $link21 10.1.22.2
tb-set-ip-link $router(13) $link21 10.1.22.3
set link22 [$ns duplex-link $router(7) $router(9) 100Mb 16.564874ms DropTail]
tb-set-ip-link $router(7) $link22 10.1.23.2
tb-set-ip-link $router(9) $link22 10.1.23.3
set link23 [$ns duplex-link $router(7) $router(14) 100Mb 45.580718ms DropTail]
tb-set-ip-link $router(7) $link23 10.1.24.2
tb-set-ip-link $router(14) $link23 10.1.24.3
set link24 [$ns duplex-link $router(7) $router(12) 100Mb 37.500557ms DropTail]
tb-set-ip-link $router(7) $link24 10.1.25.2
tb-set-ip-link $router(12) $link24 10.1.25.3
set link25 [$ns duplex-link $router(8) $router(13) 100Mb 27.500212ms DropTail]
tb-set-ip-link $router(8) $link25 10.1.26.2
tb-set-ip-link $router(13) $link25 10.1.26.3
set link26 [$ns duplex-link $router(8) $router(9) 100Mb 103.512628ms DropTail]
tb-set-ip-link $router(8) $link26 10.1.27.2
tb-set-ip-link $router(9) $link26 10.1.27.3
set link27 [$ns duplex-link $router(9) $router(12) 100Mb 54.035207ms DropTail]
tb-set-ip-link $router(9) $link27 10.1.28.2
tb-set-ip-link $router(12) $link27 10.1.28.3
set link28 [$ns duplex-link $router(10) $router(11) 100Mb 17.855103ms DropTail]
tb-set-ip-link $router(10) $link28 10.1.29.2
tb-set-ip-link $router(11) $link28 10.1.29.3
set link29 [$ns duplex-link $router(0) $site(0) 100Mb 0ms DropTail]
tb-set-ip-link $router(0) $link29 10.1.30.2
tb-set-ip-link $site(0) $link29 10.1.30.3
set link30 [$ns duplex-link $router(1) $site(1) 100Mb 0ms DropTail]
tb-set-ip-link $router(1) $link30 10.1.31.2
tb-set-ip-link $site(1) $link30 10.1.31.3
set link31 [$ns duplex-link $router(2) $site(2) 100Mb 0ms DropTail]
tb-set-ip-link $router(2) $link31 10.1.32.2
tb-set-ip-link $site(2) $link31 10.1.32.3
set link32 [$ns duplex-link $router(3) $site(3) 100Mb 0ms DropTail]
tb-set-ip-link $router(3) $link32 10.1.33.2
tb-set-ip-link $site(3) $link32 10.1.33.3
set link33 [$ns duplex-link $router(4) $site(4) 100Mb 0ms DropTail]
tb-set-ip-link $router(4) $link33 10.1.34.2
tb-set-ip-link $site(4) $link33 10.1.34.3
set link34 [$ns duplex-link $router(5) $site(5) 100Mb 0ms DropTail]
tb-set-ip-link $router(5) $link34 10.1.35.2
tb-set-ip-link $site(5) $link34 10.1.35.3
set link35 [$ns duplex-link $router(6) $site(6) 100Mb 0ms DropTail]
tb-set-ip-link $router(6) $link35 10.1.36.2
tb-set-ip-link $site(6) $link35 10.1.36.3
set link36 [$ns duplex-link $router(7) $site(7) 100Mb 0ms DropTail]
tb-set-ip-link $router(7) $link36 10.1.37.2
tb-set-ip-link $site(7) $link36 10.1.37.3
set link37 [$ns duplex-link $router(8) $site(8) 100Mb 0ms DropTail]
tb-set-ip-link $router(8) $link37 10.1.38.2
tb-set-ip-link $site(8) $link37 10.1.38.3
set link38 [$ns duplex-link $router(9) $site(9) 100Mb 0ms DropTail]
tb-set-ip-link $router(9) $link38 10.1.39.2
tb-set-ip-link $site(9) $link38 10.1.39.3
set link39 [$ns duplex-link $router(10) $site(10) 100Mb 0ms DropTail]
tb-set-ip-link $router(10) $link39 10.1.40.2
tb-set-ip-link $site(10) $link39 10.1.40.3
set link40 [$ns duplex-link $router(11) $site(11) 100Mb 0ms DropTail]
tb-set-ip-link $router(11) $link40 10.1.41.2
tb-set-ip-link $site(11) $link40 10.1.41.3
set link41 [$ns duplex-link $router(12) $site(12) 100Mb 0ms DropTail]
tb-set-ip-link $router(12) $link41 10.1.42.2
tb-set-ip-link $site(12) $link41 10.1.42.3
set link42 [$ns duplex-link $router(13) $site(13) 100Mb 0ms DropTail]
tb-set-ip-link $router(13) $link42 10.1.43.2
tb-set-ip-link $site(13) $link42 10.1.43.3
set link43 [$ns duplex-link $router(14) $site(14) 100Mb 0ms DropTail]
tb-set-ip-link $router(14) $link43 10.1.44.2
tb-set-ip-link $site(14) $link43 10.1.44.3

$ns rtproto Manual

$ns run